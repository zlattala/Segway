--This is used for checking the values we produce, we want to check what the setLeftMotorSpeedCall and setRightMotorSpeedCall is doing. 

include "Constant_Setting.csp"

Simp_Segway = Segway::disableInterruptsCall -> Segway::enableInterruptsCall -> 
Segway::angle.in?x -> Segway::gyroX.in?x1 -> Segway::leftMotorVelocity.in?x2 ->
Segway::rightMotorVelocity.in?x3 -> Segway::gyroZ.in?x4 -> Segway::setLeftMotorSpeedCall.0 -> 
Segway::setRightMotorSpeedCall.0 -> Simp_Segway

--assert Simp_Segway [T= P_Segway 
--assert P_Segway [T= Simp_Segway

--When all balanceSTM constants are 0, what PID constants make a difference: 
--AnglePID_D matters. 
--AnglePID_P does not matter (because of MaxAngle). 
--RotationPID_D matters. 

--SpeedPID_P does matter. because it operates on newError, which is currLeft and rightmotorvelocity added. 

--because that could be anything, 

--Ideal constants setup, to make all PIDs matter when everything else is 0 is: 

--SpeedPID_P = 1
--RotationPID_D = 1
--AnglePID_D = 1
--This will not be 0 and all pids will matter. 

P_Segway_P1_Renamed = P_Segway_P1[[
  Segway_P1::leftMotorVelocity <- Segway::leftMotorVelocity,
  Segway_P1::rightMotorVelocity <- Segway::rightMotorVelocity,
  Segway_P1::angle <- Segway::angle,
  Segway_P1::gyroX <- Segway::gyroX,
  Segway_P1::gyroY <- Segway::gyroY,
  Segway_P1::gyroZ <- Segway::gyroZ,
  Segway_P1::setLeftMotorSpeedCall <- Segway::setLeftMotorSpeedCall,
  Segway_P1::setRightMotorSpeedCall <- Segway::setRightMotorSpeedCall,
  Segway_P1::enableInterruptsCall <- Segway::enableInterruptsCall,
  Segway_P1::disableInterruptsCall <- Segway::disableInterruptsCall
  ]]
  

P_Segway_P2_Renamed = P_Segway_P2[[
  Segway_P2::leftMotorVelocity <- Segway::leftMotorVelocity,
  Segway_P2::rightMotorVelocity <- Segway::rightMotorVelocity,
  Segway_P2::angle <- Segway::angle,
  Segway_P2::gyroX <- Segway::gyroX,
  Segway_P2::gyroY <- Segway::gyroY,
  Segway_P2::gyroZ <- Segway::gyroZ,
  Segway_P2::setLeftMotorSpeedCall <- Segway::setLeftMotorSpeedCall,
  Segway_P2::setRightMotorSpeedCall <- Segway::setRightMotorSpeedCall,
  Segway_P2::enableInterruptsCall <- Segway::enableInterruptsCall,
  Segway_P2::disableInterruptsCall <- Segway::disableInterruptsCall
  ]]
  
--To check, we want to check that they refine, first let's just use P1, if P1 and S refine when all three components actually matter.
--FAILS.  
assert P_Segway [T= P_Segway_P2_Renamed
assert P_Segway_P2_Renamed [T= P_Segway

assert P_Segway_P2_Renamed :[deadlock-free]
